___INFO___

{
  "type": "CLIENT",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "TAGGRS - Data Client",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Webhooks van TAGGRS",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "GROUP",
    "name": "Path Settings",
    "displayName": "Allowed Request Path Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "path",
        "displayName": "Add any additional paths that needs claiming by this client",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "",
            "name": "path",
            "type": "TEXT",
            "valueHint": "/taggrs",
            "isUnique": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

// First, require the necessary server-side APIs.
const getRequestBody = require('getRequestBody');
const getRequestHeader = require('getRequestHeader');
const getRequestMethod = require('getRequestMethod');
const getRequestPath = require('getRequestPath');
const getRequestQueryParameter = require('getRequestQueryParameter');
const getRequestQueryParameters = require('getRequestQueryParameters');
const getRequestQueryString = require('getRequestQueryString');
const getRemoteAddress = require('getRemoteAddress');
const decodeUriComponent = require('decodeUriComponent');
const log = require('logToConsole');
const Object = require('Object');
const makeInteger = require('makeInteger');
const getTimestampMillis = require('getTimestampMillis');
const generateRandom = require('generateRandom');
const JSON = require('JSON');
const getType = require('getType');
const Promise = require('Promise');
const runContainer = require('runContainer');
const returnResponse = require('returnResponse');
const createRegex = require('createRegex');
const setCookie = require('setCookie');
const getCookieValues = require('getCookieValues');
const computeEffectiveTldPlusOne = require('computeEffectiveTldPlusOne');

const requestMethod = getRequestMethod();
const requestPath = getRequestPath();

log(data.path);

// call the function on receiving a request
if(requestMethod === 'GET'){
  for (let key in data.path) {
    if (data.path[key].path === requestPath) {
        onRequestReceived();
    } else {
      log('No permission, request path is not added to the data client!');
    }
  }
} else {
  log('Unsupported request method ' + requestMethod + '. Supported methods: GET');
}

/***
*  Handles the incoming request data
*/
function onRequestReceived() {
  require('claimRequest')();

  const baseEventData = getEventDataWithQueryParams();
  let eventDataCollection = getEventDataCollection(baseEventData);
  const clientId = getClientId(eventDataCollection);

  eventDataCollection = eventDataCollection.map((eventData) => {
    eventData = addStandardParamsToEventData(eventData);
    eventData = addClientIdToEventData(eventData, clientId);
    return eventData;
  });

  // store client id in cookies
  storeClientId(eventDataCollection[0]);

  // return and create a promise, return a response to GTM
  Promise.all(
    eventDataCollection.map((eventData) => {
      return Promise.create((resolve) => {
        // run the container logic
        runContainer(eventData, resolve);
      });
    })
  ).then((res) => {
    log(res);
    returnResponse();
  });
}

/***
*  Receives and retuns a collection of query parameters and their values
*/
function getEventDataWithQueryParams() {
  const requestQueryParameters = getRequestQueryParameters();
  const eventData = {};

  if (requestQueryParameters) {
    Object.keys(requestQueryParameters).forEach(function(queryParameterKey) {
      const value = requestQueryParameters[queryParameterKey];
      let parsedValue = value;
      
      // Remove surrounding quotes from the value, if any
      parsedValue = removeSurroundingQuotes(parsedValue);

      // Check if the value is a stringified array
     if (isLikelyStringifiedArray(value)) {
        parsedValue = JSON.parse(value);
     }

     eventData[queryParameterKey] = parsedValue;
    });
  }

  return eventData;
}

function removeSurroundingQuotes(str) {
  if (typeof str !== 'string') return str;

  while (str.length > 1 && ((str[0] === '"' && str[str.length - 1] === '"') || 
                             (str[0] === "'" && str[str.length - 1] === "'"))) {
    str = str.slice(1, str.length - 1);
  }

  return str;
}


/***
*  Checks for the possibility of a string being a stringified array
*/
function isLikelyStringifiedArray(value) {
  return typeof value === 'string' && value.charAt(0) === '[' && value.charAt(value.length - 1) === ']';
}

/***
*  Adds standard parameters to the eventData collection
*/
function addStandardParamsToEventData(eventData) {
  if (!eventData.event_name) {
    eventData.event_name = eventData.eventName || eventData.event || 'taggrs_webhook';
  }

  // check if ip_override parameter exists, if not
  // add it to the data
  if (!eventData.ip_override) {
    if (eventData.ip) 
      eventData.ip_override = eventData.ip;
    else if (eventData.ipOverride)
      eventData.ip_override = eventData.ipOverride;
    else 
      eventData.ip_override = getRemoteAddress();
  }
  
  if (!eventData.user_agent) {
    if (eventData.userAgent) 
      eventData.user_agent = eventData.userAgent;
    else if (getRequestHeader('User-Agent'))
      eventData.user_agent = getRequestHeader('User-Agent');
  }

  if (!eventData.language) {
    const acceptLanguageHeader = getRequestHeader('Accept-Language');

    if (acceptLanguageHeader) {
      eventData.language = acceptLanguageHeader
        .split(';')[0]
        .substring(0, 2)
        .toLowerCase();
    }
  }
  
  if(!eventData.page_referrer) {
    let str = getRequestHeader('Referer');
    let parts = str.split('?');
    eventData.page_referrer =  parts[0];
  }

  return eventData;
}

/***
*  Receives and processes the request body
*/
function getEventDataCollection(baseEventModel) {
  const body = getRequestBody();
  const eventData = [];

  // generate timestamp
  const timestamp = makeInteger(getTimestampMillis() * 1000);
 
  // generate event id
  const uniqueEventId = timestamp + '_' + generateRandom(100000000, 999999999);

  if (body) {
    JSON.parse(body);
    const bodyArray = getType(body) === 'array' && data.acceptMultipleEvents ? body : [body];

    // process the data object to be returned
    return bodyArray.map((bodyItem) => {
      let eventModel = {
        timestamp: timestamp,
        //unique_event_id: uniqueEventId,
      };
      for (let key in baseEventModel) {
        eventModel[key] = baseEventModel[key];
      }
      for (let key in bodyItem) {
        eventModel[key] = bodyItem[key];
      }
      return eventModel;
    });
  }
  
  // if no body data is present:

  const returnObject = {};

  for (const key in baseEventModel) {
    returnObject[key] = baseEventModel[key];
  }

  returnObject.timestamp = timestamp;
  //returnObject.unique_event_id = uniqueEventId;

  return [returnObject];
}

/***
*  Adds the client_id to the event data
*/
function addClientIdToEventData(eventData, clientId) {
  eventData.client_id = clientId;
  return eventData;
}

/***
*  Fetches the client_id from event data, cookies or generates
*  one when not existent
*/
function getClientId(eventDatacollection) {
  for (let i = 0; i < eventDatacollection.length; i++) {
    const eventModel = eventDatacollection[i];
    const clientId = eventModel.client_id || eventModel.data_client_id || eventModel._dcid;
    if (clientId) return clientId;
  }

  const dcid = getCookieValues('_dcid');
  if (dcid && dcid[0]) return dcid[0];

  return (
    'dcid.1.' +
    getTimestampMillis() +
     '.' +
    generateRandom(100000000, 999999999)
  );
}

/***
*  Determines the correct cookie type to be assigned
*/
function getCookieType(eventModel) {
  if (!eventModel.page_location) {
    return 'Lax';
  }

  const host = getRequestHeader('host');
  const effectiveTldPlusOne = computeEffectiveTldPlusOne(
    eventModel.page_location
  );

  if (!host || !effectiveTldPlusOne || host.indexOf(effectiveTldPlusOne) !== -1) {
    return 'Lax';
  }

  return 'None';
}

/***
*  Stores the client_is in Cookie storage
*/
function storeClientId(eventData) {
    setCookie('_dcid', eventData.client_id, {
      domain: 'auto',
      path: '/',
      samesite: getCookieType(eventData),
      secure: true,
      'max-age': 63072000, // 2 years
      httpOnly: false,
    });
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "run_container",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_dcid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Untitled test 1
  code: |-
    const mockData = {
      // Mocked field values
    };

    // Call runCode to run the template's code.
    runCode(mockData);
setup: ''


___NOTES___

Created on 28/06/2023, 16:29:22


